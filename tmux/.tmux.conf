# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'christoomey/vim-tmux-navigator'

# Add number of sessions to bar inside

set -g @plugin 'trevarj/tmux-open-nvim'
# set -g @treemux-tree-nvim-init-file '~/.tmux/plugins/treemux/configs/treemux_init.lua'
# set -g @plugin 'kiyoon/treemux'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
# Add to the beginning / end of the left and right sections your own.
# set -g @plugin 'MunifTanjim/tmux-mode-indicator'

set -g mouse on

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
# is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
#     | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
#
# bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h'  'select-pane -L'
# bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j'  'select-pane -D'
# bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k'  'select-pane -U'
# bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l'  'select-pane -R'

# tmux_version='$(tmux -V | sed -En "s/^tmux ([0-9]+(.[0-9]+)?).*/\1/p")'
#
# if-shell -b '[ "$(echo "$tmux_version < 3.0" | bc)" = 1 ]' \
#     "bind-key -n 'C-\\' if-shell \"$is_vim\" 'send-keys C-\\'  'select-pane -l'"
# if-shell -b '[ "$(echo "$tmux_version >= 3.0" | bc)" = 1 ]' \
#     "bind-key -n 'C-\\' if-shell \"$is_vim\" 'send-keys C-\\\\'  'select-pane -l'"

# Special keybinds to cut and paste panes across sessions and windows
bind-key x set-option -gF @tmux-cut-pane "#{pane_id}" \; display-message "Cut pane [#{@tmux-cut-pane}] #{pane_title}"
bind-key p run-shell -C "move-pane -s #{@tmux-cut-pane}" \; display-message "Paste pane [#{@tmux-cut-pane}] #{pane_title}"

bind-key X set-option -gF @tmux-cut-window "#{window_id}" \; display-message "Cut window [#{@tmux-cut-window}] #{window_name}"
bind-key P run-shell -C "move-window -s =#{@tmux-cut-window}" \; display-message "Paste window [#{@tmux-cut-window}] #{window_name}"

set-window-option -g mode-keys vi
set-window-option -g set-titles off

set-option -sg escape-time 10

set-option -sg focus-events on

# Set Ctrl+a as prefix
unbind C-b
set -g prefix C-a
bind-key C-a send-prefix

unbind % # Split vertically
unbind '"' # Split horizontally

# bind v split-window -h -c "#{pane_current_path}"
# bind h split-window -v -c "#{pane_current_path}"
bind \\ split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Vim keys
bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R
bind-key -T copy-mode-vi 'C-\' select-pane -l

bind-key -r -T prefix 'C-h' resize-pane -L
bind-key -r -T prefix 'C-j' resize-pane -D
bind-key -r -T prefix 'C-k' resize-pane -U
bind-key -r -T prefix 'C-l' resize-pane -R

# Zoom pane
bind-key -T prefix 'C-z' resize-pane -Z

# reload config file (change file location to your the tmux.conf you want to use)
bind r source-file ~/.config/tmux/tmux.conf

# More history
set -g history-limit 100000

unbind n  #DEFAULT KEY: Move to next window
unbind w  #DEFAULT KEY: change current window interactively

bind n command-prompt "rename-window '%%'"
bind w new-window -c "#{pane_current_path}"

# Reset window index to 1-based
set -g base-index 1
set-window-option -g pane-base-index 1

# Switch windows with Alt-j and Alt-k
bind -n M-j previous-window
bind -n M-k next-window

# Use vim keys in copy mode
set-window-option -g mode-keys vi

#### COLOUR (Solarized dark)

# default statusbar colors
# set-option -g status-style fg=yellow,bg=black #yellow and base02
#
# # default window title colors
# set-window-option -g window-status-style fg=brightblue,bg=default #base0 and default
# #set-window-option -g window-status-style dim
#
# # active window title colors
# set-window-option -g window-status-current-style fg=brightred,bg=default #orange and default
# #set-window-option -g window-status-current-style bright
#
# # pane border
# set-option -g pane-border-style fg=black #base02
# set-option -g pane-active-border-style fg=brightgreen #base01
#
# # message text
# set-option -g message-style fg=brightred,bg=black #orange and base01
#
# # pane number display
# set-option -g display-panes-active-colour brightred #orange
# set-option -g display-panes-colour blue #blue
#
# # clock
# set-window-option -g clock-mode-colour green #green
#
# # bell
# set-window-option -g window-status-bell-style fg=black,bg=red #base02, red

set -g default-terminal "tmux-256color"
set-option -ag terminal-overrides ",xterm-256color:Tc"

# themes

# set -g @plugin 'odedlaz/tmux-onedark-theme'
# set -g @plugin 'lawabidingcactus/tmux-gruvbox-truecolor'

# set -g @plugin 'niksingh710/minimal-tmux-status'
# set -g @minimal-tmux-bg "#fd8031"

# set -g @plugin 'rose-pine/tmux'
# set -g @rose_pine_variant 'moon' # Options are 'main', 'moon' or 'dawn'
# set -g @rose_pine_user 'on' # Turn on the username component in the statusbar
# set -g @rose_pine_directory 'on' # Turn on the current folder component in the status bar
# set -g @rose_pine_bar_bg_disable 'on' # Disables background color, for transparent terminal emulators
# # If @rose_pine_bar_bg_disable is set to 'on', uses the provided value to set the background color
# # It can be any of the on tmux (named colors, 256-color set, `default` or hex colors)
# # See more on http://man.openbsd.org/OpenBSD-current/man1/tmux.1#STYLES
# set -g @rose_pine_bar_bg_disabled_color_option 'default'
# set -g @rose_pine_host 'on' # Enables hostname in the status bar
# set -g @rose_pine_date_time '%R' # It accepts the date UNIX command format (man date for info)


# set -g @plugin 'wfxr/tmux-power'
# # set -g @plugin 'wfxr/tmux-net-speed'
# set -g @tmux_power_theme 'everforest'
# set -g @tmux_power_theme '#999999'
# set -g @tmux_power_theme '#d79927'
# # set -g @tmux_power_theme 'everforest'
# # set -g @tmux_power_theme '#fe8019'
# # set -g @tmux_power_date_icon ' '
# # set -g @tmux_power_time_icon ' '
# # set -g @tmux_power_user_icon ' '
# # set -g @tmux_power_session_icon ' '
# set -g @tmux_power_show_upload_speed    false
# set -g @tmux_power_show_download_speed  false
# set -g @tmux_power_show_web_reachable   false
# set -g @tmux_power_right_arrow_icon     ''
# set -g @tmux_power_left_arrow_icon      ''
# # set -g @tmux_power_upload_speed_icon    '󰕒'
# # set -g @tmux_power_download_speed_icon  '󰇚'
# set -g @tmux_power_prefix_highlight_pos 'R'

# '@pane-is-vim' is a pane-local option that is set by the plugin on load,
# and unset when Neovim exits or suspends; note that this means you'll probably
# not want to lazy-load smart-splits.nvim, as the variable won't be set until
# the plugin is loaded

# Smart pane switching with awareness of Neovim splits.
bind-key -n C-h if -F "#{@pane-is-vim}" 'send-keys C-h'  'select-pane -L'
bind-key -n C-j if -F "#{@pane-is-vim}" 'send-keys C-j'  'select-pane -D'
bind-key -n C-k if -F "#{@pane-is-vim}" 'send-keys C-k'  'select-pane -U'
bind-key -n C-l if -F "#{@pane-is-vim}" 'send-keys C-l'  'select-pane -R'

# Smart pane resizing with awareness of Neovim splits.
bind-key -n M-H if -F "#{@pane-is-vim}" 'send-keys M-h' 'resize-pane -L 3'
bind-key -n M-J if -F "#{@pane-is-vim}" 'send-keys M-j' 'resize-pane -D 3'
bind-key -n M-K if -F "#{@pane-is-vim}" 'send-keys M-k' 'resize-pane -U 3'
bind-key -n M-L if -F "#{@pane-is-vim}" 'send-keys M-l' 'resize-pane -R 3'

tmux_version='$(tmux -V | sed -En "s/^tmux ([0-9]+(.[0-9]+)?).*/\1/p")'
if-shell -b '[ "$(echo "$tmux_version < 3.0" | bc)" = 1 ]' \
    "bind-key -n 'C-\\' if -F \"#{@pane-is-vim}\" 'send-keys C-\\'  'select-pane -l'"
if-shell -b '[ "$(echo "$tmux_version >= 3.0" | bc)" = 1 ]' \
    "bind-key -n 'C-\\' if -F \"#{@pane-is-vim}\" 'send-keys C-\\\\'  'select-pane -l'"

bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R
bind-key -T copy-mode-vi 'C-\' select-pane -l

set -g @plugin 'joshmedeski/tmux-nerd-font-window-name'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# set-option -g status-position top
set -g status-justify centre
set -g status-bg default

bind-key b set-option status

# set -g @rose_pine_status_left_prepend_section '#{tmux_mode_indicator}'

# set -g status-left-length 100
# set -g status-left "#[bg=#a89992, fg=#3c3836]#{?client_prefix,#[bg=#fe8019],#[bg=#a89984]} #{session_name}"
# set -g status-right "#[bg=#9c3836, fg=#7c6f64] %Y-%m-%d %H:%M:%S #[bg=#987875, fg=#3c3836] #(whoami) #{?client_prefix,#[bg=#fe8031],#[bg=#a89984]} #{host_short} "
